<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç - {{ file_name }}</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', sans-serif;
            line-height: 1.6;
            color: #333;
            background: #f8f9fa;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            box-shadow: 0 0 20px rgba(0,0,0,0.1);
        }
        
        /* –ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ç—á–µ—Ç–∞ */
        .report-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }
        
        .report-header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .report-header .file-info {
            font-size: 1.1em;
            opacity: 0.9;
        }
        
        /* –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ */
        .toolbar {
            background: #fff;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .export-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: 500;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
        }
        
        .btn-primary {
            background: #007bff;
            color: white;
        }
        
        .btn-success {
            background: #28a745;
            color: white;
        }
        
        .btn-warning {
            background: #ffc107;
            color: #212529;
        }
        
        .btn-danger {
            background: #dc3545;
            color: white;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
        }
        
        /* –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ */
        .executive-summary {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
        }
        
        .summary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .summary-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            text-align: center;
        }
        
        .summary-card .number {
            font-size: 2em;
            font-weight: bold;
            color: #007bff;
        }
        
        .summary-card .label {
            color: #6c757d;
            margin-top: 5px;
        }
        
        .key-insights {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .key-insights h3 {
            color: #495057;
            margin-bottom: 15px;
        }
        
        .insight-item {
            padding: 10px 0;
            border-bottom: 1px solid #e9ecef;
        }
        
        .insight-item:last-child {
            border-bottom: none;
        }
        
        .insight-item::before {
            content: "‚Üí";
            color: #007bff;
            margin-right: 10px;
            font-weight: bold;
        }
        
        /* –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º */
        .section-nav {
            background: #fff;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
        }
        
        .nav-tabs {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }
        
        .nav-tab {
            padding: 12px 20px;
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 5px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            color: #495057;
        }
        
        .nav-tab.active {
            background: #007bff;
            color: white;
            border-color: #007bff;
        }
        
        .nav-tab:hover:not(.active) {
            background: #e9ecef;
        }
        
        /* –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ä–∞–∑–¥–µ–ª–æ–≤ */
        .section-content {
            padding: 30px;
            min-height: 500px;
        }
        
        .section {
            display: none;
        }
        
        .section.active {
            display: block;
        }
        
        .section h2 {
            color: #495057;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 2px solid #007bff;
        }
        
        /* –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ */
        .visualization-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 25px;
            margin-top: 20px;
        }
        
        .viz-card {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .viz-card:hover {
            transform: translateY(-5px);
        }
        
        .viz-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .viz-title {
            font-weight: bold;
            color: #495057;
        }
        
        .viz-actions {
            display: flex;
            gap: 5px;
        }
        
        .btn-small {
            padding: 5px 10px;
            font-size: 0.8em;
        }
        
        .viz-image {
            width: 100%;
            height: auto;
            border-radius: 5px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        
        /* –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ */
        .interactive-card {
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }
        
        .interactive-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }
        
        .interactive-preview {
            position: relative;
        }
        
        .overlay-hint {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .interactive-card:hover .overlay-hint {
            opacity: 1;
        }
        
        .hint-text {
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: 500;
        }
        
        /* –ó–∞–∫–ª—é—á–µ–Ω–∏–µ */
        .conclusion {
            background: #e8f5e8;
            padding: 30px;
            border-left: 5px solid #28a745;
            margin: 20px 0;
            border-radius: 8px;
        }
        
        .conclusion h3 {
            color: #155724;
            margin-bottom: 20px;
            font-size: 1.3em;
        }
        
        .conclusion ul {
            list-style: none;
            padding-left: 0;
            margin: 0;
        }
        
        .conclusion li {
            position: relative;
            padding-left: 25px;
            margin-bottom: 12px;
            line-height: 1.6;
            color: #2c5530;
        }
        
        .conclusion li:before {
            content: "‚Äî";
            position: absolute;
            left: 0;
            color: #28a745;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        .conclusion li:last-child {
            margin-bottom: 0;
        }
        
        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö —Å–ø–∏—Å–∫–æ–≤ –≤ –∑–∞–∫–ª—é—á–µ–Ω–∏–∏ */
        #conclusion ul {
            list-style: none;
            padding-left: 0;
            margin: 15px 0;
        }
        
        #conclusion li {
            position: relative;
            padding-left: 25px;
            margin-bottom: 12px;
            line-height: 1.6;
            color: #495057;
        }
        
        #conclusion li:before {
            content: "‚Äî";
            position: absolute;
            left: 0;
            color: #007bff;
            font-weight: bold;
            font-size: 1.2em;
        }
        
        #conclusion li:last-child {
            margin-bottom: 0;
        }
        
        #conclusion h3 {
            color: #495057;
            margin: 25px 0 15px 0;
            font-size: 1.3em;
            border-bottom: 2px solid #e9ecef;
            padding-bottom: 8px;
        }
        
        #conclusion p {
            line-height: 1.6;
            color: #6c757d;
            margin-bottom: 15px;
        }
        
        #conclusion strong {
            color: #495057;
        }
        
        /* –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–∞–±–ª–∏—Ü—ã */
        .stats-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        
        .stats-table th,
        .stats-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }
        
        .stats-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            backdrop-filter: blur(5px);
        }
        
        .modal-content {
            position: relative;
            margin: 2% auto;
            width: 95%;
            height: 90%;
            background: white;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            animation: modalFadeIn 0.3s ease-out;
        }
        
        @keyframes modalFadeIn {
            from {
                opacity: 0;
                transform: scale(0.9) translateY(-20px);
            }
            to {
                opacity: 1;
                transform: scale(1) translateY(0);
            }
        }
        
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            border-bottom: 1px solid #e9ecef;
            background: #f8f9fa;
            border-radius: 10px 10px 0 0;
        }
        
        .modal-title {
            font-size: 1.2em;
            font-weight: bold;
            color: #495057;
        }
        
        .modal-close {
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            font-size: 1.2em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }
        
        .modal-close:hover {
            background: #c82333;
            transform: scale(1.1);
        }
        
        .modal-body {
            height: calc(100% - 80px);
            padding: 0;
        }
        
        .modal-iframe {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 0 0 10px 10px;
        }
        
        /* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
        @media (max-width: 768px) {
            .toolbar {
                flex-direction: column;
                align-items: stretch;
            }
            
            .export-buttons {
                justify-content: center;
            }
            
            .nav-tabs {
                justify-content: center;
            }
            
            .visualization-grid {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 98%;
                height: 95%;
                margin: 1% auto;
            }
        }
        
        /* –ü–µ—á–∞—Ç—å */
        @media print {
            .toolbar,
            .nav-tabs {
                display: none;
            }
            
            .section {
                display: block !important;
                page-break-inside: avoid;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ –æ—Ç—á–µ—Ç–∞ -->
        <div class="report-header">
            <h1>üìä –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á–µ—Ç</h1>
            <div class="file-info">
                <p><strong>–§–∞–π–ª:</strong> {{ file_name }}</p>
                <p><strong>–î–∞—Ç–∞ –∞–Ω–∞–ª–∏–∑–∞:</strong> {{ created_at }}</p>
                <p><strong>ID –∞–Ω–∞–ª–∏–∑–∞:</strong> {{ analysis_id }}</p>
            </div>
        </div>

        <!-- –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤ -->
        <div class="toolbar">
            <div class="export-buttons">
                <button class="btn btn-primary" onclick="exportToPDF()">
                    üìÑ –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF
                </button>
                <button class="btn btn-success" onclick="exportToDOCX()">
                    üìù –≠–∫—Å–ø–æ—Ä—Ç –≤ Word
                </button>
                <button class="btn btn-warning" onclick="exportToExcel()">
                    üìä –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
                </button>
                <button class="btn btn-danger" onclick="printReport()">
                    üñ®Ô∏è –ü–µ—á–∞—Ç—å
                </button>
            </div>
            <div>
                <button class="btn btn-primary" onclick="copyAllGraphs()">
                    üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ –≥—Ä–∞—Ñ–∏–∫–∏
                </button>
            </div>
        </div>

        <!-- –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ -->
        <div class="executive-summary">
            <h2>üìã –ö—Ä–∞—Ç–∫–æ–µ —Ä–µ–∑—é–º–µ</h2>
            <div class="summary-grid">
                <div class="summary-card">
                    <div class="number">{{ stats.row_count }}</div>
                    <div class="label">–°—Ç—Ä–æ–∫ –¥–∞–Ω–Ω—ã—Ö</div>
                </div>
                <div class="summary-card">
                    <div class="number">{{ stats.column_count }}</div>
                    <div class="label">–°—Ç–æ–ª–±—Ü–æ–≤</div>
                </div>
                <div class="summary-card">
                    <div class="number">{{ numerical_count }}</div>
                    <div class="label">–ß–∏—Å–ª–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</div>
                </div>
                <div class="summary-card">
                    <div class="number">{{ categorical_count }}</div>
                    <div class="label">–ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</div>
                </div>
            </div>
            
            <div class="key-insights">
                <h3>üîç –ö–ª—é—á–µ–≤—ã–µ –≤—ã–≤–æ–¥—ã</h3>
                {% if insights %}
                    {% for insight in insights %}
                        <div class="insight-item">{{ insight }}</div>
                    {% endfor %}
                {% else %}
                    <div class="insight-item">–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã</div>
                    <div class="insight-item">–°–æ–∑–¥–∞–Ω—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</div>
                    <div class="insight-item">–í—ã–ø–æ–ª–Ω–µ–Ω –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —á–∏—Å–ª–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</div>
                {% endif %}
            </div>
        </div>

        <!-- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º -->
        <div class="section-nav">
            <div class="nav-tabs">
                <a href="#overview" class="nav-tab active" onclick="showSection('overview')">üìä –û–±–∑–æ—Ä –¥–∞–Ω–Ω—ã—Ö</a>
                <a href="#distributions" class="nav-tab" onclick="showSection('distributions')">üìà –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è</a>
                <a href="#correlations" class="nav-tab" onclick="showSection('correlations')">üîó –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏</a>
                <a href="#categorical" class="nav-tab" onclick="showSection('categorical')">üìä –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ</a>
                <a href="#timeseries" class="nav-tab" onclick="showSection('timeseries')">üìÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã</a>
                <a href="#outliers" class="nav-tab" onclick="showSection('outliers')">‚ö†Ô∏è –í—ã–±—Ä–æ—Å—ã</a>
                <a href="#advanced" class="nav-tab" onclick="showSection('advanced')">üî¨ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–Ω–∞–ª–∏–∑</a>
                <a href="#conclusion" class="nav-tab" onclick="showSection('conclusion')">üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ</a>
            </div>
        </div>

        <!-- –°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Ä–∞–∑–¥–µ–ª–æ–≤ -->
        <div class="section-content">
            <!-- –û–±–∑–æ—Ä –¥–∞–Ω–Ω—ã—Ö -->
            <div id="overview" class="section active">
                <h2>üìä –û–±–∑–æ—Ä –¥–∞–Ω–Ω—ã—Ö</h2>
                <p>–í –¥–∞–Ω–Ω–æ–º —Ä–∞–∑–¥–µ–ª–µ –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∞ –æ–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –∏ –∫–∞—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö.</p>
                
                <h3>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ —Å—Ç–æ–ª–±—Ü–∞–º</h3>
                {% if stats.numeric_stats %}
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>–°—Ç–æ–ª–±–µ—Ü</th>
                            <th>–°—Ä–µ–¥–Ω–µ–µ</th>
                            <th>–ú–µ–¥–∏–∞–Ω–∞</th>
                            <th>–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–µ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ</th>
                            <th>–ú–∏–Ω–∏–º—É–º</th>
                            <th>–ú–∞–∫—Å–∏–º—É–º</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for col, stats_data in stats.numeric_stats.items() %}
                        <tr>
                            <td><strong>{{ col }}</strong></td>
                            <td>{{ "%.2f"|format(stats_data.mean) if stats_data.mean else "N/A" }}</td>
                            <td>{{ "%.2f"|format(stats_data['50%']) if stats_data['50%'] else "N/A" }}</td>
                            <td>{{ "%.2f"|format(stats_data.std) if stats_data.std else "N/A" }}</td>
                            <td>{{ "%.2f"|format(stats_data.min) if stats_data.min else "N/A" }}</td>
                            <td>{{ "%.2f"|format(stats_data.max) if stats_data.max else "N/A" }}</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% endif %}
                
                <h3>–ü—Ä–æ–ø—É—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è</h3>
                {% if stats.missing_values %}
                <table class="stats-table">
                    <thead>
                        <tr>
                            <th>–°—Ç–æ–ª–±–µ—Ü</th>
                            <th>–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø—Ä–æ–ø—É—Å–∫–æ–≤</th>
                            <th>–ü—Ä–æ—Ü–µ–Ω—Ç</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for col, count in stats.missing_values.items() %}
                        <tr>
                            <td><strong>{{ col }}</strong></td>
                            <td>{{ count }}</td>
                            <td>{{ "%.1f"|format(count / stats.row_count * 100) }}%</td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
                {% endif %}
            </div>

            <!-- –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è -->
            <div id="distributions" class="section">
                <h2>üìà –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π</h2>
                <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç, –∫–∞–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω—ã –∑–Ω–∞—á–µ–Ω–∏—è –≤ —á–∏—Å–ª–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è.</p>
                <div class="visualization-grid">
                    {% for viz in visualizations %}
                        {% if viz.type == 'interactive_distribution' %}
                            <div class="viz-card interactive-card" onclick="openInteractiveModal('{{ viz.path }}', '{{ viz.type }}', '{{ viz.column }}', '', '')">
                                <div class="viz-header">
                                    <div class="viz-title">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: {{ viz.column }}</div>
                                    <div class="viz-actions">
                                        <button class="btn btn-small btn-primary" onclick="event.stopPropagation(); copyInteractiveGraph('{{ viz.path }}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="btn btn-small btn-success" onclick="event.stopPropagation(); downloadInteractiveGraph('{{ viz.path }}')">üíæ –°–∫–∞—á–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="interactive-preview">
                                    <iframe src="/static/analyses/{{ analysis_id }}/{{ viz.path }}" 
                                            width="100%" 
                                            height="300px" 
                                            frameborder="0"
                                            style="border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); pointer-events: none;">
                                    </iframe>
                                    <div class="overlay-hint">
                                        <div class="hint-text">üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

            <!-- –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ -->
            <div id="correlations" class="section">
                <h2>üîó –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑</h2>
                <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —Å–≤—è–∑–µ–π –º–µ–∂–¥—É —á–∏—Å–ª–æ–≤—ã–º–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è.</p>
                <div class="visualization-grid">
                    {% for viz in visualizations %}
                        {% if viz.type == 'interactive_correlation' %}
                            <div class="viz-card interactive-card" onclick="openInteractiveModal('{{ viz.path }}', '{{ viz.type }}', '', '', '')">
                                <div class="viz-header">
                                    <div class="viz-title">–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞</div>
                                    <div class="viz-actions">
                                        <button class="btn btn-small btn-primary" onclick="event.stopPropagation(); copyInteractiveGraph('{{ viz.path }}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="btn btn-small btn-success" onclick="event.stopPropagation(); downloadInteractiveGraph('{{ viz.path }}')">üíæ –°–∫–∞—á–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="interactive-preview">
                                    <iframe src="/static/analyses/{{ analysis_id }}/{{ viz.path }}" 
                                            width="100%" 
                                            height="300px" 
                                            frameborder="0"
                                            style="border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); pointer-events: none;">
                                    </iframe>
                                    <div class="overlay-hint">
                                        <div class="hint-text">üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        {% if viz.type == 'interactive_scatter' %}
                            <div class="viz-card interactive-card" onclick="openInteractiveModal('{{ viz.path }}', '{{ viz.type }}', '', '{{ viz.x_column }}', '{{ viz.y_column }}')">
                                <div class="viz-header">
                                    <div class="viz-title">{{ viz.x_column }} vs {{ viz.y_column }}</div>
                                    <div class="viz-actions">
                                        <button class="btn btn-small btn-primary" onclick="event.stopPropagation(); copyInteractiveGraph('{{ viz.path }}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="btn btn-small btn-success" onclick="event.stopPropagation(); downloadInteractiveGraph('{{ viz.path }}')">üíæ –°–∫–∞—á–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="interactive-preview">
                                    <iframe src="/static/analyses/{{ analysis_id }}/{{ viz.path }}" 
                                            width="100%" 
                                            height="300px" 
                                            frameborder="0"
                                            style="border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); pointer-events: none;">
                                    </iframe>
                                    <div class="overlay-hint">
                                        <div class="hint-text">üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

            <!-- –ö–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ -->
            <div id="categorical" class="section">
                <h2>üìä –ê–Ω–∞–ª–∏–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö</h2>
                <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è.</p>
                <div class="visualization-grid">
                    {% for viz in visualizations %}
                        {% if viz.type == 'interactive_bar' %}
                            <div class="viz-card interactive-card" onclick="openInteractiveModal('{{ viz.path }}', '{{ viz.type }}', '{{ viz.column }}', '', '')">
                                <div class="viz-header">
                                    <div class="viz-title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏: {{ viz.column }}</div>
                                    <div class="viz-actions">
                                        <button class="btn btn-small btn-primary" onclick="event.stopPropagation(); copyInteractiveGraph('{{ viz.path }}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="btn btn-small btn-success" onclick="event.stopPropagation(); downloadInteractiveGraph('{{ viz.path }}')">üíæ –°–∫–∞—á–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="interactive-preview">
                                    <iframe src="/static/analyses/{{ analysis_id }}/{{ viz.path }}" 
                                            width="100%" 
                                            height="300px" 
                                            frameborder="0"
                                            style="border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); pointer-events: none;">
                                    </iframe>
                                    <div class="overlay-hint">
                                        <div class="hint-text">üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

            <!-- –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã -->
            <div id="timeseries" class="section">
                <h2>üìÖ –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ä—è–¥—ã</h2>
                <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤–æ –≤—Ä–µ–º–µ–Ω–∏. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è.</p>
                <div class="visualization-grid">
                    {% for viz in visualizations %}
                        {% if viz.type == 'interactive_time_series' %}
                            <div class="viz-card interactive-card" onclick="openInteractiveModal('{{ viz.path }}', '{{ viz.type }}', '', '{{ viz.x_column }}', '{{ viz.y_column }}')">
                                <div class="viz-header">
                                    <div class="viz-title">{{ viz.y_column }} –ø–æ {{ viz.x_column }}</div>
                                    <div class="viz-actions">
                                        <button class="btn btn-small btn-primary" onclick="event.stopPropagation(); copyInteractiveGraph('{{ viz.path }}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="btn btn-small btn-success" onclick="event.stopPropagation(); downloadInteractiveGraph('{{ viz.path }}')">üíæ –°–∫–∞—á–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="interactive-preview">
                                    <iframe src="/static/analyses/{{ analysis_id }}/{{ viz.path }}" 
                                            width="100%" 
                                            height="300px" 
                                            frameborder="0"
                                            style="border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); pointer-events: none;">
                                    </iframe>
                                    <div class="overlay-hint">
                                        <div class="hint-text">üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

            <!-- –í—ã–±—Ä–æ—Å—ã -->
            <div id="outliers" class="section">
                <h2>‚ö†Ô∏è –ê–Ω–∞–ª–∏–∑ –≤—ã–±—Ä–æ—Å–æ–≤</h2>
                <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –∞–Ω–æ–º–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π –≤ –¥–∞–Ω–Ω—ã—Ö. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –≥—Ä–∞—Ñ–∏–∫ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è.</p>
                <div class="visualization-grid">
                    {% for viz in visualizations %}
                        {% if viz.type == 'interactive_box' %}
                            <div class="viz-card interactive-card" onclick="openInteractiveModal('{{ viz.path }}', '{{ viz.type }}', '{{ viz.column }}', '', '')">
                                <div class="viz-header">
                                    <div class="viz-title">Box Plot: {{ viz.column }}</div>
                                    <div class="viz-actions">
                                        <button class="btn btn-small btn-primary" onclick="event.stopPropagation(); copyInteractiveGraph('{{ viz.path }}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="btn btn-small btn-success" onclick="event.stopPropagation(); downloadInteractiveGraph('{{ viz.path }}')">üíæ –°–∫–∞—á–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="interactive-preview">
                                    <iframe src="/static/analyses/{{ analysis_id }}/{{ viz.path }}" 
                                            width="100%" 
                                            height="300px" 
                                            frameborder="0"
                                            style="border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); pointer-events: none;">
                                    </iframe>
                                    <div class="overlay-hint">
                                        <div class="hint-text">üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

            <!-- –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–Ω–∞–ª–∏–∑ -->
            <div id="advanced" class="section">
                <h2>üî¨ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–π –∞–Ω–∞–ª–∏–∑</h2>
                <p>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –º–µ—Ç–æ–¥—ã –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö: 3D –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è, –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∫–æ–æ—Ä–¥–∏–Ω–∞—Ç—ã, scatter matrix –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã.</p>
                <div class="visualization-grid">
                    {% for viz in visualizations %}
                        {% if viz.type == '3d_scatter' %}
                            <div class="viz-card interactive-card" onclick="openInteractiveModal('{{ viz.path }}', '{{ viz.type }}', '', '', '')">
                                <div class="viz-header">
                                    <div class="viz-title">3D Scatter Plot —Å –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏–µ–π</div>
                                    <div class="viz-actions">
                                        <button class="btn btn-small btn-primary" onclick="event.stopPropagation(); copyInteractiveGraph('{{ viz.path }}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="btn btn-small btn-success" onclick="event.stopPropagation(); downloadInteractiveGraph('{{ viz.path }}')">üíæ –°–∫–∞—á–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="interactive-preview">
                                    <iframe src="/static/analyses/{{ analysis_id }}/{{ viz.path }}" 
                                            width="100%" 
                                            height="300px" 
                                            frameborder="0"
                                            style="border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); pointer-events: none;">
                                    </iframe>
                                    <div class="overlay-hint">
                                        <div class="hint-text">üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        {% if viz.type == 'parallel_coordinates' %}
                            <div class="viz-card interactive-card" onclick="openInteractiveModal('{{ viz.path }}', '{{ viz.type }}', '', '', '')">
                                <div class="viz-header">
                                    <div class="viz-title">Parallel Coordinates Plot</div>
                                    <div class="viz-actions">
                                        <button class="btn btn-small btn-primary" onclick="event.stopPropagation(); copyInteractiveGraph('{{ viz.path }}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="btn btn-small btn-success" onclick="event.stopPropagation(); downloadInteractiveGraph('{{ viz.path }}')">üíæ –°–∫–∞—á–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="interactive-preview">
                                    <iframe src="/static/analyses/{{ analysis_id }}/{{ viz.path }}" 
                                            width="100%" 
                                            height="300px" 
                                            frameborder="0"
                                            style="border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); pointer-events: none;">
                                    </iframe>
                                    <div class="overlay-hint">
                                        <div class="hint-text">üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        {% if viz.type == 'scatter_matrix' %}
                            <div class="viz-card interactive-card" onclick="openInteractiveModal('{{ viz.path }}', '{{ viz.type }}', '', '', '')">
                                <div class="viz-header">
                                    <div class="viz-title">Scatter Matrix</div>
                                    <div class="viz-actions">
                                        <button class="btn btn-small btn-primary" onclick="event.stopPropagation(); copyInteractiveGraph('{{ viz.path }}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="btn btn-small btn-success" onclick="event.stopPropagation(); downloadInteractiveGraph('{{ viz.path }}')">üíæ –°–∫–∞—á–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="interactive-preview">
                                    <iframe src="/static/analyses/{{ analysis_id }}/{{ viz.path }}" 
                                            width="100%" 
                                            height="300px" 
                                            frameborder="0"
                                            style="border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); pointer-events: none;">
                                    </iframe>
                                    <div class="overlay-hint">
                                        <div class="hint-text">üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                        {% if viz.type == 'qq_plot' %}
                            <div class="viz-card interactive-card" onclick="openInteractiveModal('{{ viz.path }}', '{{ viz.type }}', '{{ viz.column }}', '', '')">
                                <div class="viz-header">
                                    <div class="viz-title">Q-Q Plot: {{ viz.column }}</div>
                                    <div class="viz-actions">
                                        <button class="btn btn-small btn-primary" onclick="event.stopPropagation(); copyInteractiveGraph('{{ viz.path }}')">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å</button>
                                        <button class="btn btn-small btn-success" onclick="event.stopPropagation(); downloadInteractiveGraph('{{ viz.path }}')">üíæ –°–∫–∞—á–∞—Ç—å</button>
                                    </div>
                                </div>
                                <div class="interactive-preview">
                                    <iframe src="/static/analyses/{{ analysis_id }}/{{ viz.path }}" 
                                            width="100%" 
                                            height="300px" 
                                            frameborder="0"
                                            style="border-radius: 5px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); pointer-events: none;">
                                    </iframe>
                                    <div class="overlay-hint">
                                        <div class="hint-text">üëÜ –ù–∞–∂–º–∏—Ç–µ –¥–ª—è —É–≤–µ–ª–∏—á–µ–Ω–∏—è</div>
                                    </div>
                                </div>
                            </div>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>

            <!-- –ó–∞–∫–ª—é—á–µ–Ω–∏–µ -->
            <div id="conclusion" class="section">
                <h2>üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ –∏ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h2>
                
                <div class="conclusion">
                    <h3>üéØ –û—Å–Ω–æ–≤–Ω—ã–µ –≤—ã–≤–æ–¥—ã</h3>
                    <ul>
                        {% if insights %}
                            {% for insight in insights %}
                                <li>{{ insight }}</li>
                            {% endfor %}
                        {% else %}
                            <li>–î–∞–Ω–Ω—ã–µ —É—Å–ø–µ—à–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã</li>
                            <li>–°–æ–∑–¥–∞–Ω—ã –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</li>
                            <li>–í—ã–ø–æ–ª–Ω–µ–Ω –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ —á–∏—Å–ª–æ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö</li>
                            <li>–ü—Ä–æ–≤–µ–¥–µ–Ω –∞–Ω–∞–ª–∏–∑ –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –∞–Ω–æ–º–∞–ª–∏–π</li>
                        {% endif %}
                    </ul>
                </div>

                <h3>üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏</h3>
                <div class="recommendations">
                    <p><strong>–î–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–≥–æ –∞–Ω–∞–ª–∏–∑–∞ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è:</strong></p>
                    <ul>
                        <li>–ò–∑—É—á–∏—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–µ –≥—Ä–∞—Ñ–∏–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö</li>
                        <li>–û–±—Ä–∞—Ç–∏—Ç—å –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞ –≤—ã—è–≤–ª–µ–Ω–Ω—ã–µ –≤—ã–±—Ä–æ—Å—ã –∏ –∞–Ω–æ–º–∞–ª–∏–∏</li>
                        <li>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–∏ –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –ø—Ä–æ–≥–Ω–æ–∑–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π</li>
                        <li>–†–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–µ–≥–º–µ–Ω—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –æ—Å–Ω–æ–≤–µ –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–≥–æ –∞–Ω–∞–ª–∏–∑–∞</li>
                    </ul>
                </div>

                <h3>üìä –ú–µ—Ç–æ–¥–æ–ª–æ–≥–∏—è</h3>
                <p>–î–∞–Ω–Ω—ã–π –æ—Ç—á–µ—Ç –±—ã–ª —Å–æ–∑–¥–∞–Ω —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –≤–∫–ª—é—á–∞—é—â–µ–π:</p>
                <ul>
                    <li>–°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ –∏ –æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</li>
                    <li>–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫</li>
                    <li>–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è –≤—ã—è–≤–ª–µ–Ω–∏—è —Å–≤—è–∑–µ–π</li>
                    <li>–ê–Ω–∞–ª–∏–∑ –≤—ã–±—Ä–æ—Å–æ–≤ –∏ –∞–Ω–æ–º–∞–ª–∏–π</li>
                    <li>–ö–ª–∞—Å—Ç–µ—Ä–Ω—ã–π –∞–Ω–∞–ª–∏–∑ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö</li>
                    <li>–ê–Ω–∞–ª–∏–∑ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤ (–ø—Ä–∏ –Ω–∞–ª–∏—á–∏–∏ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö)</li>
                </ul>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ -->
    <div id="interactiveModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title" id="modalTitle">–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫</div>
                <button class="modal-close" onclick="closeInteractiveModal()">&times;</button>
            </div>
            <div class="modal-body">
                <iframe id="modalIframe" class="modal-iframe" src=""></iframe>
            </div>
        </div>
    </div>

    <script>
        // –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ —Ä–∞–∑–¥–µ–ª–∞–º
        function showSection(sectionId) {
            // –°–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ —Ä–∞–∑–¥–µ–ª—ã
            const sections = document.querySelectorAll('.section');
            sections.forEach(section => {
                section.classList.remove('active');
            });
            
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫
            const tabs = document.querySelectorAll('.nav-tab');
            tabs.forEach(tab => {
                tab.classList.remove('active');
            });
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–∞–∑–¥–µ–ª
            document.getElementById(sectionId).classList.add('active');
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤–∫–ª–∞–¥–∫–µ
            event.target.classList.add('active');
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
        function copyGraph(imagePath) {
            const img = document.querySelector(`img[src="/static/analyses/{{ analysis_id }}/${imagePath}"]`);
            if (img) {
                // –°–æ–∑–¥–∞–µ–º canvas –¥–ª—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                canvas.width = img.naturalWidth;
                canvas.height = img.naturalHeight;
                ctx.drawImage(img, 0, 0);
                
                canvas.toBlob(function(blob) {
                    const item = new ClipboardItem({ "image/png": blob });
                    navigator.clipboard.write([item]).then(function() {
                        alert('–ì—Ä–∞—Ñ–∏–∫ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
                    });
                });
            }
        }

        // –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–∞
        function downloadGraph(imagePath) {
            const link = document.createElement('a');
            link.href = `/static/analyses/{{ analysis_id }}/${imagePath}`;
            link.download = imagePath;
            link.click();
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤
        function copyAllGraphs() {
            alert('–§—É–Ω–∫—Ü–∏—è –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö –≥—Ä–∞—Ñ–∏–∫–æ–≤ –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏');
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ PDF
        function exportToPDF() {
            window.print();
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ Word
        function exportToDOCX() {
            alert('–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Word –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏');
        }

        // –≠–∫—Å–ø–æ—Ä—Ç –≤ Excel
        function exportToExcel() {
            alert('–§—É–Ω–∫—Ü–∏—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –≤ Excel –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏');
        }

        // –ü–µ—á–∞—Ç—å –æ—Ç—á–µ—Ç–∞
        function printReport() {
            window.print();
        }

        // –û—Ç–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ —Å –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–º –≥—Ä–∞—Ñ–∏–∫–æ–º
        function openInteractiveModal(graphPath, graphType, column, xColumn, yColumn) {
            const modal = document.getElementById('interactiveModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalIframe = document.getElementById('modalIframe');
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫
            let title = '–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫';
            if (graphType === 'interactive_distribution') {
                title = `–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ: ${column}`;
            } else if (graphType === 'interactive_correlation') {
                title = '–ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞';
            } else if (graphType === 'interactive_scatter') {
                title = `${xColumn} vs ${yColumn}`;
            } else if (graphType === 'interactive_bar') {
                title = `–ö–∞—Ç–µ–≥–æ—Ä–∏–∏: ${column}`;
            } else if (graphType === 'interactive_time_series') {
                title = `–í—Ä–µ–º–µ–Ω–Ω–æ–π —Ä—è–¥: ${yColumn}`;
            } else if (graphType === 'interactive_box') {
                title = `Box Plot: ${column}`;
            }
            
            modalTitle.textContent = title;
            
            // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫ iframe
            modalIframe.src = `/static/analyses/{{ analysis_id }}/${graphPath}`;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            modal.style.display = 'block';
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.body.style.overflow = 'hidden';
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞
        function closeInteractiveModal() {
            const modal = document.getElementById('interactiveModal');
            const modalIframe = document.getElementById('modalIframe');
            
            // –û—á–∏—â–∞–µ–º iframe
            modalIframe.src = '';
            
            // –°–∫—Ä—ã–≤–∞–µ–º –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ
            modal.style.display = 'none';
            
            // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ–∫—Ä—É—Ç–∫—É —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            document.body.style.overflow = 'auto';
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        window.onclick = function(event) {
            const modal = document.getElementById('interactiveModal');
            if (event.target === modal) {
                closeInteractiveModal();
            }
        }

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø–æ –∫–ª–∞–≤–∏—à–µ Escape
        document.addEventListener('keydown', function(event) {
            if (event.key === 'Escape') {
                closeInteractiveModal();
            }
        });

        // –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞
        function downloadInteractiveGraph(graphPath) {
            const link = document.createElement('a');
            link.href = `/static/analyses/{{ analysis_id }}/${graphPath}`;
            link.download = graphPath;
            link.click();
        }

        // –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –≥—Ä–∞—Ñ–∏–∫–∞ (HTML)
        function copyInteractiveGraph(graphPath) {
            fetch(`/static/analyses/{{ analysis_id }}/${graphPath}`)
                .then(response => response.text())
                .then(html => {
                    const blob = new Blob([html], { type: 'text/html' });
                    const item = new ClipboardItem({ 'text/html': blob });
                    navigator.clipboard.write([item]).then(function() {
                        alert('HTML –≥—Ä–∞—Ñ–∏–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤ –±—É—Ñ–µ—Ä –æ–±–º–µ–Ω–∞!');
                    }, function(err) {
                        alert('–û—à–∏–±–∫–∞ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è: ' + err);
                    });
                });
        }
    </script>
</body>
</html> 